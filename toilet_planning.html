<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Map Dropdown Selection</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map { height: 600px; }
        .dropdown { margin: 20px; }
    </style>
</head>
<body>

<select id="geojson-dropdown" class="dropdown">
    <option value="toilets-only">Toilets Only</option>
    <option value="1km-cover">1km Cover</option>
    <option value="2km-cover">2km Cover</option>
    <option value="1km-buffer-uncovered">1km Buffer Uncovered</option>
    <option value="2km-buffer-uncovered">2km Buffer Uncovered</option>
</select>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    // Initialize the map
    const map = L.map('map').setView([22.2, 113.9], 13);

    // Add OpenStreetMap tile layer
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
    }).addTo(map);

    // Define the geojson layers
    const layers = {
        toilets: L.geoJSON(null, { style: { color: 'green' } }), // toilet_csv20250326.csv
        cover1km: L.geoJSON(null, { style: { color: 'blue', weight: 4 } }), // toilet_planning_1km.geojson
        cover2km: L.geoJSON(null, { style: { color: 'purple', weight: 4 } }), // toilet_planning_2km.geojson
        buffer1km: L.geoJSON(null, {
            style: { color: 'darkblue', weight: 4 }
        }), // buffer_1km_invert_edit.geojson
        buffer2km: L.geoJSON(null, {
            style: { color: 'darkpurple', weight: 4 }
        }), // buffer_2km_invert_edit.geojson
        buffer1km_edit: L.geoJSON(null, {
            style: { color: 'darkblue', weight: 2, opacity: 0.5 }
        }), // buffer_1km_invert_edit_buffer4326.geojson
        buffer2km_edit: L.geoJSON(null, {
            style: { color: 'darkpurple', weight: 2, opacity: 0.5 }
        }) // buffer_2km_invert_edit_buffer4326.geojson
    };

    // Load the toilet CSV data
    // Assuming you have a function to load CSV data and convert it to geoJSON
    loadCSV('path/to/toilet_csv20250326.csv').then(data => {
        layers.toilets.addData(data);
        layers.toilets.addTo(map);
    });

    // Function to load geojson files
    async function loadGeoJSON(url) {
        const response = await fetch(url);
        return await response.json();
    }

    // Handle dropdown selection
    document.getElementById('geojson-dropdown').addEventListener('change', function() {
        const value = this.value;

        // Clear all layers except toilets
        for (const key in layers) {
            if (key !== 'toilets') {
                map.removeLayer(layers[key]);
            }
        }

        // Add relevant layers based on selection
        if (value === '1km-cover') {
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/toilet_planning_1km.geojson').then(data => {
                layers.cover1km.addData(data);
                layers.cover1km.addTo(map);
            });
        } else if (value === '2km-cover') {
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/toilet_planning_2km.geojson').then(data => {
                layers.cover2km.addData(data);
                layers.cover2km.addTo(map);
            });
        } else if (value === '1km-buffer-uncovered') {
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/buffer_1km_invert_edit.geojson').then(data => {
                layers.buffer1km.addData(data);
                layers.buffer1km.addTo(map);
            });
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/buffer_1km_invert_edit_buffer4326.geojson').then(data => {
                layers.buffer1km_edit.addData(data);
                layers.buffer1km_edit.addTo(map);
            });
        } else if (value === '2km-buffer-uncovered') {
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/buffer_2km_invert_edit.geojson').then(data => {
                layers.buffer2km.addData(data);
                layers.buffer2km.addTo(map);
            });
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/buffer_2km_invert_edit_buffer4326.geojson').then(data => {
                layers.buffer2km_edit.addData(data);
                layers.buffer2km_edit.addTo(map);
            });
        }
    });
</script>

</body>
</html>
