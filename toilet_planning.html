<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>汽站位置</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <style>
        html, body {
            margin: 0;
            height: 100%; /* Ensures the body takes full height */
            display: flex;
            flex-direction: column; /* Column layout for the body */
        }

        #map {
            flex: 1; /* Allow the map to take up remaining space */
            width: 100%; /* Full width */
            z-index: 1; /* Lower z-index for the map */
            position: relative; /* Create a positioning context */
        }

        .controls-container {
            position: relative; /* Allows for absolute positioning of dropdowns */
            z-index: 10; /* Ensure dropdowns are above the map */
        }

        h2 {
            margin-bottom: 10px; /* Space between title and dropdowns */
            text-align: center; /* Center the title */
            color: white; /* Change header text color for visibility */
        }

        .dropdown-row {
            display: flex; /* Align dropdowns in a row */
            justify-content: space-between; /* Space out dropdowns evenly */
            z-index: 20; /* Higher z-index to ensure it floats above the map */
            background-color: #333; /* Background color for the dropdown container */
            padding: 10px; /* Padding around the dropdown row */
            box-sizing: border-box; /* Include padding in width */
        }

        .dropdown-container {
            flex: 1; /* Allow each dropdown to take equal space */
            display: flex; /* Use flexbox for internal layout */
            flex-direction: column; /* Stack label and dropdown vertically */
            margin: 0 5px; /* Optional margin between dropdowns */
            box-sizing: border-box; /* Include padding in width */
        }

        .dropdown-container label {
            margin-bottom: 5px; /* Space between label and dropdown */
            color: white; /* Change label color for visibility */
            text-align: center; /* Center the label text */
            white-space: nowrap; /* Prevent label text from wrapping */
        }

        select {
            background-color: #444; /* Darker background for the select dropdowns */
            color: white; /* White text for dropdowns */
            border: none; /* Remove default border */
            padding: 5px; /* Padding inside dropdown */
            border-radius: 3px; /* Rounded corners for aesthetics */
            width: 100%; /* Make select take full width of the container */
            box-sizing: border-box; /* Ensure padding is included in width */
        }

        select:focus {
            outline: none; /* Remove focus outline */
            border: 1px solid #666; /* Optional border on focus */
        }

        .footer {
            display: flex; /* Use flexbox for layout */
            align-items: center; /* Center items vertically */
            justify-content: space-between; /* Space between left content and button */
            background-color: #333; /* Background color for footer */
            color: white; /* Text color */
            padding: 10px; /* Padding around the footer */
        }

        .footer-content {
            display: flex; /* Use flexbox for inner content */
            align-items: center; /* Center the icon and text vertically */
        }

        .footer-icon {
            height: 3em; /* Set height to match two lines of text */
            margin-right: 10px; /* Space between image and text */
        }

        .footer h3 {
            margin: 0; /* Remove default margin */
            line-height: 1.4; /* Adjust line height for spacing */
        }

        .whatsapp-button {
            background-color: #25D366; /* WhatsApp green */
            color: white; /* Button text color */
            padding: 10px 15px; /* Padding for the button */
            border-radius: 5px; /* Rounded corners */
            text-decoration: none; /* Remove underline */
            display: flex; /* Center the text */
            align-items: center; /* Center text vertically */
            margin-left: 40px; /* Add space between footer content and button */
        }

        button {
            display: flex;
            padding: 0.75rem;
            background-color: rgb(237, 28, 36); /* Button color */
            color: white; /* Text color */
            border: none; /* Remove default border */
            border-radius: 4px; /* Rounded corners */
            cursor: pointer; /* Pointer cursor on hover */
            font-size: 1rem; /* Font size */
        }
    </style>
</head>
<body>

<select id="geojson-dropdown" class="dropdown">
    <option value="toilets-only">Toilets Only</option>
    <option value="1km-cover">1km Cover</option>
    <option value="2km-cover">2km Cover</option>
    <option value="1km-buffer-uncovered">1km Buffer Uncovered</option>
    <option value="2km-buffer-uncovered">2km Buffer Uncovered</option>
</select>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
    // Initialize the map
    const map = L.map('map').setView([22.2, 113.9], 13);

    // Add OpenStreetMap tile layer
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
    }).addTo(map);

    // Define the geojson layers
    const layers = {
        toilets: L.geoJSON(null, { style: { color: 'green' } }), // toilet_point_json.geojson
        cover1km: L.geoJSON(null, { style: { color: 'blue', weight: 4 } }), // toilet_planning_1km.geojson
        cover2km: L.geoJSON(null, { style: { color: 'purple', weight: 4 } }), // toilet_planning_2km.geojson
        buffer1km: L.geoJSON(null, {
            style: { color: 'darkblue', weight: 4 }
        }), // buffer_1km_invert_edit.geojson
        buffer2km: L.geoJSON(null, {
            style: { color: 'darkpurple', weight: 4 }
        }), // buffer_2km_invert_edit.geojson
        buffer1km_edit: L.geoJSON(null, {
            style: { color: 'darkblue', weight: 2, opacity: 0.5 }
        }), // buffer_1km_invert_edit_buffer4326.geojson
        buffer2km_edit: L.geoJSON(null, {
            style: { color: 'darkpurple', weight: 2, opacity: 0.5 }
        }) // buffer_2km_invert_edit_buffer4326.geojson
    };

    // Load the toilet GeoJSON data
    loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/toilet_point_json.geojson').then(data => {
        layers.toilets.addData(data);
        layers.toilets.addTo(map);
    });

    // Function to load geojson files
    async function loadGeoJSON(url) {
        const response = await fetch(url);
        return await response.json();
    }

    // Handle dropdown selection
    document.getElementById('geojson-dropdown').addEventListener('change', function() {
        const value = this.value;

        // Clear all layers except toilets
        for (const key in layers) {
            if (key !== 'toilets') {
                map.removeLayer(layers[key]);
            }
        }

        // Add relevant layers based on selection
        if (value === '1km-cover') {
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/toilet_planning_1km.geojson').then(data => {
                layers.cover1km.addData(data);
                layers.cover1km.addTo(map);
            });
        } else if (value === '2km-cover') {
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/toilet_planning_2km.geojson').then(data => {
                layers.cover2km.addData(data);
                layers.cover2km.addTo(map);
            });
        } else if (value === '1km-buffer-uncovered') {
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/buffer_1km_invert_edit.geojson').then(data => {
                layers.buffer1km.addData(data);
                layers.buffer1km.addTo(map);
            });
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/buffer_1km_invert_edit_buffer4326.geojson').then(data => {
                layers.buffer1km_edit.addData(data);
                layers.buffer1km_edit.addTo(map);
            });
        } else if (value === '2km-buffer-uncovered') {
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/buffer_2km_invert_edit.geojson').then(data => {
                layers.buffer2km.addData(data);
                layers.buffer2km.addTo(map);
            });
            loadGeoJSON('https://raw.githubusercontent.com/KU1311/taxi_info/main/buffer_2km_invert_edit_buffer4326.geojson').then(data => {
                layers.buffer2km_edit.addData(data);
                layers.buffer2km_edit.addTo(map);
            });
        }
    });
</script>

</body>
</html>
